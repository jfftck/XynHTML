
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>XynHTML Examples</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/theme-toggles@4.10.1/css/within.min.css">
    
    <!-- Highlight.js CSS - Default theme, will be overridden by JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" id="highlight-theme">
    
    <!-- Highlight.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
    
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link href="examples/local-theme.css" rel="stylesheet" type="text/css" />
    <script src="examples/index.js" type="module" defer></script>
</head>

<body>
    <h1>XynHTML</h1>
    <h2>Examples of Signals</h2>

    <h3>Importing XynHTML</h3>
    <pre><code class="language-javascript">// Import the XynHTML library functions
import { 
    signal, 
    effect, 
    derived, 
    XynTag, 
    text, 
    createMount 
} from "./xyn_html.js"

// Alternative: Import the main class and use static methods
import XynHTML from "./xyn_html.js";
const mySignal = XynHTML.signal("Hello");

// Available exports:
// - signal: Create reactive signals
// - effect: Create side effects that react to signal changes
// - derived: Create computed signals
// - XynTag: Create HTML elements
// - text: Create reactive text nodes
// - createMount: Mount components to DOM</code></pre>

    <!-- Example 1: Basic Signal Usage -->
    <h3>Example 1: Basic Signal Usage</h3>
    <pre><code class="language-javascript">const counter = signal(0);
output("Initial counter value: " + counter.value);

// Subscribe to changes
const counterSubscriber = () => {
    output("Counter changed to: " + counter.value);
};
counter.subscribe(counterSubscriber);

// Update the signal value
counter.value = 5;
counter.value = 10;

// Unsubscribe
counter.unsubscribe(counterSubscriber);</code></pre>
    <div id="example1-output"></div>

    <!-- Example 2: Multiple Signals and Effects -->
    <h3>Example 2: Multiple Signals and Effects</h3>
    <pre><code class="language-javascript">const firstName = signal("John");
const lastName = signal("Doe");

// Effect that runs when either signal changes
const unsubscribeEffect = effect(() => {
    output(`Full name: ${firstName.value} ${lastName.value}`);
}, [firstName, lastName]);

firstName.value = "Jane";
lastName.value = "Smith";</code></pre>
    <div id="example2-output"></div>

    <!-- Example 3: Derived Values -->
    <h3>Example 3: Derived Values</h3>
    <pre><code class="language-javascript">const price = signal(100);
const quantity = signal(2);
const taxRate = signal(0.1);

// Derived signal for subtotal
const subtotal = derived(() => {
    return price.value * quantity.value;
}, [price, quantity]);

// Derived signal for total with tax
const total = derived(() => {
    return subtotal.value * (1 + taxRate.value);
}, [subtotal, taxRate]);</code></pre>
    <div id="example3-output"></div>

    <!-- Example 4: Complex State Management -->
    <h3>Example 4: Complex State Management</h3>
    <pre><code class="language-javascript">const todos = signal([]);
const filter = signal("all"); // "all", "completed", "pending"

// Derived signal for filtered todos
const filteredTodos = derived(() => {
    if (filter.value === "completed") {
        return todos.value.filter(todo => todo.completed);
    } else if (filter.value === "pending") {
        return todos.value.filter(todo => !todo.completed);
    }
    return todos.value;
}, [todos, filter]);</code></pre>
    <div id="example4-output"></div>

    <!-- Example 5: Performance -->
    <h3>Example 5: Performance - No Unnecessary Updates</h3>
    <pre><code class="language-javascript">const performanceSignal = signal("test");
let updateCount = 0;

const perfSubscriber = () => {
    updateCount++;
    output(`Performance signal updated ${updateCount} times, value: ${performanceSignal.value}`);
};
performanceSignal.subscribe(perfSubscriber);

// Setting same value (should not trigger update)
performanceSignal.value = "test";

// Setting different value (should trigger update)
performanceSignal.value = "new value";</code></pre>
    <div id="example5-output"></div>

    <!-- Example 6: Subscription Management -->
    <h3>Example 6: Subscription Management</h3>
    <pre><code class="language-javascript">const tempSignal = signal(0);
let cleanupCount = 0;

const tempSubscriber = () => {
    cleanupCount++;
    output(`Temp signal updated ${cleanupCount} times`);
};
tempSignal.subscribe(tempSubscriber);

tempSignal.value = 1;
tempSignal.value = 2;

// Unsubscribing
tempSignal.unsubscribe(tempSubscriber);

// This update won't trigger the subscriber
tempSignal.value = 3;</code></pre>
    <div id="example6-output"></div>

    <!-- Example 7: Chained Derived Values -->
    <h3>Example 7: Chained Derived Values</h3>
    <pre><code class="language-javascript">const textInput = signal("hello world");

const uppercase = derived(() => {
    return textInput.value.toUpperCase();
}, [textInput]);

const wordCount = derived(() => {
    return uppercase.value.split(' ').length;
}, [uppercase]);

const analysis = derived(() => {
    return {
        original: textInput.value,
        uppercase: uppercase.value,
        wordCount: wordCount.value,
        charCount: textInput.value.length
    };
}, [textInput, uppercase, wordCount]);</code></pre>
    <div id="example7-output"></div>

    <!-- Example 8: Multiple Subscribers -->
    <h3>Example 8: Multiple Subscribers to One Signal</h3>
    <pre><code class="language-javascript">const sharedSignal = signal("shared");

const subscriber1 = () => {
    output("Subscriber 1 received: " + sharedSignal.value);
};
const subscriber2 = () => {
    output("Subscriber 2 received: " + sharedSignal.value);
};
const subscriber3 = () => {
    output("Subscriber 3 received: " + sharedSignal.value);
};

sharedSignal.subscribe(subscriber1);
sharedSignal.subscribe(subscriber2);
sharedSignal.subscribe(subscriber3);

sharedSignal.value = "updated value";

// Remove one subscriber
sharedSignal.unsubscribe(subscriber2);</code></pre>
    <div id="example8-output"></div>

    <!-- Example 9: Direct Signal Subscription -->
    <h3>Example 9: Direct Signal Subscription</h3>
    <pre><code class="language-javascript">const directSignal = signal("initial");

const directSubscriber1 = () => {
    output("Direct subscriber 1: " + directSignal.value);
};
const directSubscriber2 = () => {
    output("Direct subscriber 2: " + directSignal.value);
};

// Subscribe directly to the signal
directSignal.subscribe(directSubscriber1);
directSignal.subscribe(directSubscriber2);

directSignal.value = "first update";
directSignal.value = "second update";

// Unsubscribe one subscriber
directSignal.unsubscribe(directSubscriber1);</code></pre>
    <div id="example9-output"></div>

    <!-- Example 10: DOM Creation -->
    <h3>Example 10: DOM Creation with XynTag and createMount</h3>
    <pre><code class="language-javascript">const buttonText = signal("Click me!");
const clickCount = signal(0);

// Create a button with reactive text
const button = new XynTag("button");
button.children = [text`${buttonText}`];

// Add click handler
const buttonElement = button.render();
buttonElement.onclick = () => {
    clickCount.value++;
    buttonText.value = `Clicked ${clickCount.value} times`;
};

// Create a div container and mount using createMount
const container = new XynTag("div");
container.children = [button];
container.render().className = "example-container";

// Append to document body directly
document.body.appendChild(container.render());</code></pre>
    <div id="example10-output"></div>

    <!-- Example 11: Dynamic List -->
    <h3>Example 11: Dynamic List with XynTag and createMount</h3>
    <pre><code class="language-javascript">const items = signal(["Apple", "Banana", "Cherry"]);

// Create list container
const listContainer = new XynTag("div");
const itemInput = new XynTag("input");
const addButton = new XynTag("button");
const itemList = new XynTag("ul");

// Configure components
itemInput.children = [];
addButton.children = [text`Add Item`];

// Render and configure input and button
const inputElement = itemInput.render();
inputElement.placeholder = "Enter new item";

const buttonElement = addButton.render();
buttonElement.onclick = () => {
    if (inputElement.value.trim()) {
        items.value = [...items.value, inputElement.value.trim()];
        inputElement.value = "";
    }
};

// Build the complete list container
listContainer.children = [itemInput, addButton, itemList];
document.body.appendChild(listContainer.render());</code></pre>
    <div id="example11-output"></div>

    <!-- Example 12: Conditional Rendering -->
    <h3>Example 12: Conditional Rendering with XynSwitch</h3>
    <pre><code class="language-javascript">import { XynSwitch } from "./src/xyn_html.js";

const isVisible = signal(true);
const localTheme = signal(globalTheme.value);
const message = signal("Hello from XynHTML!");

// Create a styled card
const card = new XynTag("div");
const cardTitle = new XynTag("h3");
cardTitle.children = [text`Interactive Card`];
const cardContent = new XynTag("p");
cardContent.children = [text`${message}`];

// Create placeholder for hidden state
const hiddenPlaceholder = new XynTag("div");
hiddenPlaceholder.children = [text`Card is hidden`];

// Create XynSwitch for conditional rendering
const cardSwitch = new XynSwitch(isVisible, new Map([
    [true, card],
    [false, hiddenPlaceholder]
]));</code></pre>
    <div id="example12-output"></div>

    <!-- Example 13: Form Validation -->
    <h3>Example 13: Form with Reactive Validation</h3>
    <pre><code class="language-javascript">const email = signal("");
const password = signal("");

const isValidEmail = derived(() => {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value);
}, [email]);

const isValidPassword = derived(() => {
    return password.value.length >= 8;
}, [password]);

const isFormValid = derived(() => {
    return isValidEmail.value && isValidPassword.value;
}, [isValidEmail, isValidPassword]);

const form = new XynTag("form");
const mountForm = createMount(form, "body");
mountForm();</code></pre>
    <div id="example13-output"></div>

    <script>
        // Initialize highlight.js after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            hljs.highlightAll();
        });
    </script>
</body>

</html>
